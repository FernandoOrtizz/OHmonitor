<!DOCTYPE html>
<html lang="en">

<head>
    <title>OHMONITOR</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-database.js"></script>
    <link rel="stylesheet" href="./styles.css" />
    <script src="app.js"></script>
    <script type="text/javascript">
        google.charts.load("current", {
            packages: ["corechart"],
        });
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            let firstTemp = 0,
                secondTemp = 0,
                thirdTemp = 0,
                fourthTemp = 0;

            firebase.initializeApp({
                apiKey: "AIzaSyDBqL6EPdkdX1sOQcmqM4CB6_RqliNksT4",
                authDomain: "temperatura-11955.firebaseapp.com",
                databaseURL: "https://temperatura-11955.firebaseio.com",
                projectId: "temperatura-11955",
                storageBucket: "temperatura-11955.appspot.com",
                messagingSenderId: "1002993199143",
                appId: "1:1002993199143:web:495650022d8ce47cc98602",
                measurementId: "G-DE7BFTW12H",
            });

            let db = firebase.database().ref().child("TEMPERATURA").child("Grados");
            db.on("value", (snap) => {
                console.log(snap.val());
                for (let element of snap.val()) {
                    if (element >= 35 && element < 37.5) {
                        firstTemp = firstTemp + 1;
                    } else if (element >= 37.5 && element < 40) {
                        secondTemp = secondTemp + 1;
                    } else if (element >= 40 && element < 42.5) {
                        thirdTemp = thirdTemp + 1;
                        //console.log(thirdTemp);
                    } else if (element >= 42.5 && element <= 45) {
                        fourthTemp = fourthTemp + 1;
                    }
                }
                var data = google.visualization.arrayToDataTable([
                    ["Temperatura", "Registros"],
                    ["35 a 37.5째", firstTemp],
                    ["37.5 a 40째", secondTemp],
                    ["40 a 42.5째", thirdTemp],
                    ["42.5 a 45째", fourthTemp],
                ]);

                var options = {
                    title: "Temperaturas - IHSS (San Pedro Sula)",
                    hAxis: {
                        title: "",
                        titleTextStyle: {
                            color: "#333",
                        },
                    },
                    vAxis: {
                        minValue: 0,
                    },
                };

                var chart = new google.visualization.BarChart(
                    document.getElementById("chart_div")
                );
                chart.draw(data, options);
            });
        }
    </script>
</head>

<body>
    <div class="main-container">
        <h1 class="title">Online Health Monitor</h1>
    </div>
    <div id="chart_div" style="width: 100%; height: 500px"></div>
</body>

</html>